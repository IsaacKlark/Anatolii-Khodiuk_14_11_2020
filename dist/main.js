(()=>{"use strict";const e=(e,t)=>{const i=document.createElement(e);return i.className=t,i},t=()=>{const i=e("div","favouritesMoviesList"),o=e("div","favouritesHeaderWrapper"),a=e("img","headerImage"),n=e("h2","favourtiteHeader");n.innerText="Favourite List",a.src="./src/images/star_active.png",a.alt="Favourite List",o.append(a),o.append(n),i.append(o);let s=JSON.parse(localStorage.getItem("moviesList"))?.movies||[];const d=e=>{s=s.filter((t=>t.movieId!==e)),localStorage.setItem("moviesList",JSON.stringify({movies:s}));const i=document.querySelectorAll(".starButton");for(let t=0;t<i.length;t++)+i[t].dataset.id===e&&(i[t].className="starButton inactiveStar");document.querySelector(".favouritesMovies").innerHTML=t().outerHTML};return s.forEach((t=>{const o=e("div","favouriteMoviesWrapper"),r=e("div","favouriteMovieName");r.role="button",r.innerText=t.movieName,r.dataset.id=t.movieId;const a=e("button","removeFavouriteMovie");a.type="button",a.innerText="x",a.title="remove from list",a.dataset.id=t.movieId,o.append(r),o.append(a),i.append(o)})),setTimeout((()=>{const e=document.querySelectorAll(".removeFavouriteMovie"),t=document.querySelectorAll(".favouriteMovieName");for(let i=0;i<e.length;i++)e[i].addEventListener("click",(e=>{d(+e.target.dataset.id)})),t[i].addEventListener("click",(()=>{r(+t[i].dataset.id)}))}),0),i},i=t,o=()=>{document.querySelector(".movieDetailsWrapper").remove(),document.querySelector(".moviesWrapper").style.display="block",document.querySelector(".favouritesMovies").style.display="block"},r=t=>{document.querySelector(".preLoader").style.display="block",document.querySelector(".moviesWrapper").style.display="none",document.querySelector(".favouritesMovies").style.display="none",fetch("https://my-json-server.typicode.com/moviedb-tech/movies/list/"+t).then((e=>e.json()),(e=>{alert(e),document.querySelector(".preLoader").style.display="none"})).then((t=>{document.querySelector(".preLoader").style.display="none";const r=e("div","movieDetailsWrapper"),a=e("div","topMovieDetailsWrapper"),n=e("img","movieDetailedImage"),s=e("div","movieDescriptionWrapper"),d=e("h1","favourtiteHeader"),p=e("p","movieDescription"),l=e("div","bottomMovieDetailsWrapper"),c=e("div","movieDetailedImage"),m=e("div",""),v=e("div","detailsWrapper"),u=e("div","detailsWrapper"),y=e("button","starButtonDescription"),g=e("img","starImageDescription"),f=e("p","yearDescription"),S=JSON.parse(localStorage.getItem("moviesList"))?.movies||[];let h=!1;const L=e("div","productionInfoWrapper"),x=e("div","productionInfoWrapper"),I=e("p","productionInfoCategorie"),T=e("p","productionInfoCategorie"),M=e("p","director"),q=e("p","director"),N=e("button","closeButton");N.type="button",N.innerText="x",q.innerText=t.starring.join(", "),T.innerText="Starrings: ",M.innerText=t.director,S.forEach((e=>{e.movieId===t.id&&(h=!0)})),I.innerText="Director: ",f.innerText=t.year,g.src=h?"./src/images/star_active.png":"./src/images/star_inactive.png",g.alt="add to favourite collection",p.innerText=t.description,d.innerText=t.name,n.src=t.img,n.alt=t.name,y.type="button",t.genres.forEach((t=>{const i=e("p","genre");i.innerText=t,u.append(i)})),y.addEventListener("click",(()=>{((e,t)=>{let o=JSON.parse(localStorage.getItem("moviesList"))?.movies||[],r=!1;const a=document.querySelectorAll(".starButton");if(o.forEach((i=>{if(i.movieId===t.id){e.src="./src/images/star_inactive.png",o=o.filter((e=>e.movieId!==t.id)),r=!0;for(let e=0;e<a.length;e++)+a[e].dataset.id===t.id&&(a[e].className="starButton inactiveStar")}})),!r){e.src="./src/images/star_active.png",o.push({movieName:t.name,movieId:t.id});for(let e=0;e<a.length;e++)+a[e].dataset.id===t.id&&(a[e].className="starButton activeStar")}localStorage.setItem("moviesList",JSON.stringify({movies:o})),document.querySelector(".favouritesMovies").innerHTML=i().outerHTML})(g,t)})),N.addEventListener("click",o),L.append(I),L.append(M),m.append(L),x.append(T),x.append(q),m.append(x),y.append(g),v.append(y),v.append(f),c.append(v),c.append(u),l.append(c),l.append(m),s.append(d),s.append(p),a.append(n),a.append(s),r.append(a),r.append(l),r.append(N),document.body.append(r)}),(e=>{alert(e),document.querySelector(".preLoader").style.display="none"}))},a=(e,t,o)=>{e.stopPropagation();const r=JSON.parse(localStorage.getItem("moviesList"))||{movies:[]};let a=[...r.movies];"starButton inactiveStar"===e.target.className?(e.target.className="starButton activeStar",a.push({movieName:t,movieId:o})):(e.target.className="starButton inactiveStar",a=a.filter((e=>e.movieName!==t))),r.movies=a,localStorage.setItem("moviesList",JSON.stringify(r)),document.querySelector(".favouritesMovies").innerHTML=i().outerHTML},n=t=>{const i=e("div","moviesWrapper"),o=e("div","moviesList");for(let i=0;i<t.length;i++){const n=e("div","movie"),s=e("div","imageWrapper"),d=e("img","movieImage");n.dataset.id=t[i].id,d.src=t[i].img,d.alt=t[i].name,n.addEventListener("click",(()=>{r(t[i].id)})),s.append(d);const p=e("p","movieName");p.innerText=t[i].name;const l=e("p","movieYear");l.innerText=t[i].year;let c=!1;(JSON.parse(localStorage.getItem("moviesList"))?.movies||[]).forEach((e=>{e.movieId===t[i].id&&(c=!0)}));const m=e("button",c?"starButton activeStar":"starButton inactiveStar");m.dataset.id=t[i].id,m.type="button",m.title=c?"remove from collection":"add to collection",m.addEventListener("click",(e=>{a(e,t[i].name,t[i].id)})),n.append(s),n.append(p),n.append(l),n.append(m),o.append(n)}const n=e("h1","moviesWrapperHeader"),s=e("select","input"),d=e("option","");d.selected=!0,d.value="card",d.innerText="card",s.id="view";const p=e("option","");p.value="list",p.innerText="list",s.append(d),s.append(p),s.addEventListener("change",(e=>{(e=>{const t=document.querySelectorAll(".movie"),i=document.querySelectorAll(".imageWrapper");if("list"===e.target.value)for(let e=0;e<t.length;e++)t[e].style.width="100%",t[e].style.marginTop="0",t[e].style.marginBottom="0",t[e].style.flexDirection="row",t[e].style.alignItems="center",t[e].style.borderRadius="0",i[e].style.width="200px";else for(let e=0;e<t.length;e++)t[e].style.width="300px",t[e].style.marginTop="15px",t[e].style.marginBottom="15px",t[e].style.flexDirection="column",t[e].style.alignItems="flexStart",t[e].style.borderRadius="5px",i[e].style.width="100%"})(e)}));const l=e("input","input");l.type="text",l.placeholder="filter by genres",l.addEventListener("input",(e=>{((e,t)=>{let i=t.map((t=>{for(let i=0;i<t.genres.length;i++)if(t.genres[i].toLowerCase().includes(e.target.value.toLowerCase()))return t;return null})).filter((e=>e)).map((e=>e.id));e.target.value||(i=t.map((e=>e.id)));const o=document.querySelectorAll(".movie");for(let e=0;e<o.length;e++)i.includes(+o[e].dataset.id)?o[e].style.display="flex":o[e].style.display="none"})(e,t)})),n.innerText="Movies Gallery",i.append(n),i.append(l),i.append(s),i.append(o),document.body.appendChild(i)};fetch("https://my-json-server.typicode.com/moviedb-tech/movies/list").then((e=>e.json()),(e=>{alert(e),document.querySelector(".preLoader").style.display="none"})).then((t=>{n(t),document.querySelector(".preLoader").style.display="none";const o=e("div","favouritesMovies");o.innerHTML=i().outerHTML,document.body.appendChild(o)}),(e=>{alert(e),document.querySelector(".preLoader").style.display="none"}))})();